@model MyCollections.ViewModels.ItemProfileViewModel
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

<link href="~/css/ItemsPage.css" rel="stylesheet"/>


<div class="fs-3">
    <ui>
        <img src="@Url.Content(Model.Item.Image)" style="width: 150px; height: 200px;" alt=""/>
        <li>@Model.Item.Name</li>
        <li>@Model.Item.Tag</li>
        <li>@Model.Item.Description</li>

        @if (Model.ItemLikes != null)
        {
            <li>Лайки: @Model.ItemLikes.Count()</li>
        }
    </ui>
</div>
<p></p>
<p></p>
<p></p>
<p></p>
@if (User.Identity.IsAuthenticated)
{
    <form method="post">

        <div class="mb-3">
            <label for="com" class="form-label fs-4"> Ваш комментарий</label>
            <textarea class="form-control" name="comment"></textarea>
        </div>

        <button type="submit" class="btn btn-primary" name="userName" value="@User.Identity.Name" formaction="~/Collection/SetItemComment" onSubmit="window.location.reload()">Отправить</button>
        <input name="idItem" value="@Model.Item.Id" style="visibility: hidden" size="1"/>
    </form>
}

<p></p>
<p></p>
<p></p>
<p></p>

<div class="widget widget-comments open" id="comments">
    <div class="block-title">Комментарии:</div>

    <ol class="list-group list-group-numbered">
        @if (Model.ItemComments != null)
        {
            <p style="visibility: hidden"> @Model.ItemComments.OrderByDescending(i => i.Date);</p>
            @foreach (var i in Model.ItemComments)
            {

                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">

                            <form method="post" asp-action="UserProfile" asp-controller="User">

                                @if (User.Identity.IsAuthenticated)
                                {
                                    <input name="name" value="@i.UserName" style="visibility: hidden" size="1"/>
                                    <input type="submit" name="button" value="@i.UserName" class="btn btn-link text-dark" formaction="~/User/UserProfile">
                                }
                                else
                                {
                                    <a class="text-dark">@i.UserName</a>
                                }
                            </form>
                            <a>@i.Date</a>
                            <p>----------------</p>
                        </div>
                        @i.Comment
                    </div>
                </li>
            }
        }
    </ol>
</div>